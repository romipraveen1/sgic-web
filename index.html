<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SGI Alumni - View Post</title>

    <!-- Open Graph Meta Tags for Social Sharing -->
    <meta property="og:title" content="SGI Alumni Network - View Post" />
    <meta
      property="og:description"
      content="Join our Alumni Network to connect with fellow alumni and view exclusive content."
    />
    <meta
      property="og:image"
      content="https://romipraveen1.github.io/sgic-web/assets/logo.png"
    />
    <meta property="og:url" content="https://romipraveen1.github.io/sgic-web" />
    <meta property="og:type" content="website" />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="SGI Alumni Network - View Post" />
    <meta
      name="twitter:description"
      content="Join our Alumni Network to connect with fellow alumni and view exclusive content."
    />
    <meta
      name="twitter:image"
      content="https://romipraveen1.github.io/sgic-web/assets/logo.png"
    />

    <!-- App Store Meta Tags -->
    <meta name="apple-itunes-app" content="app-id=123456789" />
    <meta name="google-play-app" content="app-id=com.sgicalumni" />

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
      }

      .container {
        text-align: center;
        max-width: 400px;
        padding: 2rem;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      }

      .logo {
        width: 80px;
        height: 80px;
        margin: 0 auto 1.5rem;
        background: white;
        border-radius: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        font-weight: bold;
        color: #667eea;
      }

      h1 {
        font-size: 1.8rem;
        margin-bottom: 1rem;
        font-weight: 600;
      }

      p {
        font-size: 1rem;
        margin-bottom: 2rem;
        opacity: 0.9;
        line-height: 1.5;
      }

      .buttons {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .btn {
        padding: 1rem 2rem;
        border: none;
        border-radius: 12px;
        font-size: 1rem;
        font-weight: 600;
        text-decoration: none;
        display: inline-block;
        transition: all 0.3s ease;
        cursor: pointer;
      }

      .btn-primary {
        background: white;
        color: #667eea;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }

      .btn-secondary {
        background: rgba(255, 255, 255, 0.2);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.3);
      }

      .btn-secondary:hover {
        background: rgba(255, 255, 255, 0.3);
      }

      .loading {
        display: none;
        margin-top: 1rem;
      }

      .spinner {
        width: 20px;
        height: 20px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-top: 2px solid white;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        display: inline-block;
        margin-right: 0.5rem;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .footer {
        margin-top: 2rem;
        font-size: 0.8rem;
        opacity: 0.7;
      }

      @media (max-width: 480px) {
        .container {
          margin: 1rem;
          padding: 1.5rem;
        }

        h1 {
          font-size: 1.5rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="logo">SGI</div>
      <h1>SGI Alumni Network</h1>
      <p>Opening your post in the Alumni app...</p>

      <div class="loading" id="loading">
        <div class="spinner"></div>
        <span>Redirecting...</span>
      </div>

      <div class="buttons" id="buttons">
        <a href="#" class="btn btn-primary" id="openApp">Open in App</a>
        <a href="#" class="btn btn-secondary" id="downloadApp">Download App</a>
      </div>

      <div class="footer">
        <p>
          Connect with fellow alumni and stay updated with the latest news and
          events.
        </p>
      </div>
    </div>

    <script>
      // Configuration
      const APP_SCHEME = "sgicalumni";
      const PLAY_STORE_URL =
        "https://play.google.com/store/apps/details?id=com.sgicalumni";
      const APP_STORE_URL = "https://apps.apple.com/app/sgi-alumni/id123456789";
      const WEB_APP_URL = "https://romipraveen1.github.io/sgic-web/app";

      // Get post ID from URL
      function getPostIdFromUrl() {
        const pathParts = window.location.pathname.split("/").filter(Boolean);
        // Path structure: /sgic-web/app/home/post/{postId}
        if (
          pathParts.length >= 5 &&
          pathParts[0] === "sgic-web" &&
          pathParts[1] === "app" &&
          pathParts[2] === "home" &&
          pathParts[3] === "post"
        ) {
          return pathParts[4];
        }
        return null;
      }

      // Detect if user is on mobile
      function isMobile() {
        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
          navigator.userAgent
        );
      }

      // Detect platform
      function getPlatform() {
        if (/iPad|iPhone|iPod/.test(navigator.userAgent)) return "ios";
        if (/Android/.test(navigator.userAgent)) return "android";
        return "desktop";
      }

      // Try to open the app
      function tryOpenApp(postId) {
        const deepLink = `${APP_SCHEME}://app/home/post/${postId}`;

        // Show loading
        document.getElementById("loading").style.display = "block";
        document.getElementById("buttons").style.display = "none";

        // Try to open the app
        window.location.href = deepLink;

        // Fallback after 2 seconds
        setTimeout(() => {
          document.getElementById("loading").style.display = "none";
          document.getElementById("buttons").style.display = "flex";

          // Update the message
          document.querySelector("p").textContent =
            "Couldn't open the app? Download it now or continue in your browser.";
        }, 2000);
      }

      // Get app store URL based on platform
      function getAppStoreUrl() {
        const platform = getPlatform();
        return platform === "ios" ? APP_STORE_URL : PLAY_STORE_URL;
      }

      // Initialize the page
      function init() {
        const postId = getPostIdFromUrl();
        const platform = getPlatform();
        const mobile = isMobile();

        // Update download button
        const downloadBtn = document.getElementById("downloadApp");
        downloadBtn.href = getAppStoreUrl();
        downloadBtn.textContent =
          platform === "ios"
            ? "Download from App Store"
            : "Download from Play Store";

        if (postId && mobile) {
          // On mobile with valid post ID, try to open app immediately
          setTimeout(() => tryOpenApp(postId), 1000);

          // Set up open app button
          document.getElementById("openApp").onclick = (e) => {
            e.preventDefault();
            tryOpenApp(postId);
          };
        } else {
          // On desktop or invalid post ID, show options immediately
          document.getElementById("loading").style.display = "none";
          document.getElementById("buttons").style.display = "flex";

          if (!postId) {
            document.querySelector("p").textContent =
              "Join our Alumni Network to connect with fellow alumni!";
          } else {
            document.querySelector("p").textContent =
              "View this post in our Alumni app or download it now.";
          }

          // Set up open app button for desktop (opens web app)
          document.getElementById("openApp").onclick = (e) => {
            e.preventDefault();
            if (mobile && postId) {
              tryOpenApp(postId);
            } else {
              window.location.href = WEB_APP_URL;
            }
          };

          if (!mobile) {
            document.getElementById("openApp").textContent = "Open Web App";
          }
        }
      }

      // Run when page loads
      document.addEventListener("DOMContentLoaded", init);

      // Handle page visibility change (for app switching detection)
      document.addEventListener("visibilitychange", () => {
        if (document.hidden) {
          // User switched to app, hide loading
          setTimeout(() => {
            document.getElementById("loading").style.display = "none";
          }, 500);
        }
      });
    </script>
  </body>
</html>
